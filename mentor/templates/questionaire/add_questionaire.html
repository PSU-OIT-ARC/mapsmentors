{% extends "base.html" %}

{% block page_title %}Response to the form{% endblock %}

{% load questionaire_tags %}
{% block content %}
<script type="text/javascript">

    function show_fields(){
        var identity = $("input:radio[name='identity']:checked").val();
        var who_fill_form = $("input:radio[name='on_behalf_of_student']:checked").val();

        if (identity == "ST") {
            // Show student view: Name of mentor, university study, concern
            $("#id_hidden_mentor_name").show()
            $("#id_hidden_university_studies").show()
            $("#id_hidden_concern").show()

            // Hide other parts
            $("#id_hidden_student_name").hide()
            $("#id_hidden_who_fill_form").hide()

        }

        else if (identity == "MT") {
            if (who_fill_form) {
                if (who_fill_form == 'Y') {
                    // Show mentor view to fill student problem: name of student, university study, concern
                    $("#id_hidden_student_name").show()
                    $("#id_hidden_university_studies").show()
                    $("#id_hidden_concern").show()
                    $("#id_hidden_who_fill_form").show()

                    // Hide other parts
                    $("#id_hidden_mentor_name").hide()
                }

                else if(who_fill_form == "N") {
                    // Show mentor view to fill mentor problem
                    $("#id_hidden_concern").show()
                    $("#id_hidden_who_fill_form").show()

                    // Hide other parts
                    $("#id_hidden_student_name").hide()
                    $("#id_hidden_mentor_name").hide()
                    $("#id_hidden_university_studies").hide()
                }
            }
            else {
                // Show mentor view: Ask if it is mentor's problem or student's problem
                $("#id_hidden_who_fill_form").show()

                // Hide other parts
                $("#id_hidden_student_name").hide()
                $("#id_hidden_mentor_name").hide()
                $("#id_hidden_university_studies").hide()
                $("#id_hidden_concern").hide()
            }

        }

        else {
            
            $("#id_hidden_who_fill_form").hide()
            $("#id_hidden_student_name").hide()
            $("#id_hidden_mentor_name").hide()
            $("#id_hidden_university_studies").hide()
            $("#id_hidden_concern").hide()
            
        }
    }

    $(function() {
        $("#id_follow_up_appointment").datepicker();
        show_fields();
        $("input:radio").click(show_fields);

        $("#id_follow_up_phone_0").autotab({ format: 'number', target: '#id_follow_up_phone_1'});
        $("#id_follow_up_phone_1").autotab({ format: 'number', target: '#id_follow_up_phone_2', previous: '#id_follow_up_phone_0'});
        $("#id_follow_up_phone_2").autotab({ format: 'number', previous: '#id_follow_up_phone_1'});

    });
</script>
<div class="container-fluid " >

    <h2>MAPS Support Webform</h2>
    {% if form.errors %}
        <p class="error">Errors detected: Please correct them before you can continue.</p>
    {% endif %}

    <form role="form" method="post" class="form-horizontal">
        {% csrf_token %}

        
        <!-- Name -->

        <div class="form-group" >
            <legend>General information</legend>
            <div class="row">
                <div class="control-label col-sm-2">
                    {{ form.name.label_tag}}
                </div>
                <div class="col-sm-3">
                    {{ form.name }}
                </div>
                <div class="control-label col-sm-3">
                    {{ form.student_ID.label_tag }}
                </div>
                <div class="col-sm-3">
                    {{ form.student_ID }}
                </div>
            </div>   
            <div class="row text-danger">
                <div class="col-sm-2"></div>
                <div class="col-sm-10">
                    {{ form.name.errors }}
                </div>
            </div>
        </div>
        <div class="form-group">
            <div class="row">
                <div class="col-sm-5">
                    {{ form.identity.label_tag }} 
                </div>
                <div class="col-sm-4">
                    {{ form.identity }}
                </div>
            </div>
        </div>
        

        <!-- PART 2: Mentor fill out the form about student/mentor problem -->
        <div id="id_hidden_who_fill_form" class="form-group">
            <div class="row">
                <div class="col-sm-5" >
                    {{ form.on_behalf_of_student.label_tag }}
                </div>
                <div class="col-sm-4">
                    {{ form.on_behalf_of_student }}
                </div>
                <div class="col-sm-4">
                    {{ form.on_behalf_of_student.errors }}
                </div>
            </div>
        </div>

        <!-- PART 3: Student/Mentor name -->
        <div class="form-group" id="id_hidden_student_name" >    
            <div class="row">  
                <div class="col-sm-2">
                    {{ form.student_name.label_tag }} 
                </div>
                <div class="col-sm-4">
                    {{ form.student_name }}
                </div>
                <div class="col-sm-4">
                    {{ form.student_name.errors }}
                </div>
            </div>
        </div>

         <!-- Mentor name field -->
        <div class="form-group" id="id_hidden_mentor_name" >   
            <div class="row">   
                <div class="col-sm-2">
                    {{ form.mentor_name.label_tag }} 
                </div>
                <div class="col-sm-4">
                    {{ form.mentor_name }}
                </div>
                <div class="col-sm-4">
                    {{ form.mentor_name.errors }}
                </div>
            </div>
        </div>
        

        <!-- PART 4: University Studies information if you are student -->
        <div id="id_hidden_university_studies" class="form-group" >
            <legend>University studies</legend>
            <div class="row">
                <div class="col-sm-7" >
                    {{ form.UNST_course.label_tag }} 
                </div>
                <div class="col-sm-4">
                    {{ form.UNST_course }}
                </div>
            </div>
            <br/>
            <div class="row">
                <div class="col-sm-7">
                    {{ form.type_of_course.label_tag }} 
                </div>
                <div class="col-sm-4">
                    {{ form.type_of_course }}
                </div>
            </div>
        </div>
        

        <!-- HIDDEN PARTS -->
        <div id="id_hidden_concern" class="form-group" >
            <legend>Primary Concern</legend>
            <!-- Primary concernt field -->
            <div class="row">
                <div class="col-sm-7">
                    {{ form.primary_concern.label_tag }}
                </div>
                <div class="col-sm-5">
                    {{ form.primary_concern.errors }}
                </div>
                <div class="col-sm-12">
                    {{ form.primary_concern }}
                </div>
            </div>

            <!-- Step taken form field -->
            <div class="row">
                <div class="col-sm-8">
                    {{ form.step_taken.label_tag }}
                </div>
                <div class="col-sm-4">
                    {{ form.step_taken.errors }}
                </div>
                <div class="col-sm-12">
                    {{ form.step_taken }}
                </div>
            </div>

            <!-- When step is taken -->
            <br/>
            <div class="row">
                <div class="col-sm-7">
                    {{ form.when_take_step.label_tag}}
                </div>
                <div class="col-sm-4">
                    {{ form.when_take_step }}
                </div>
            </div>

            <!-- Support from MAPS field -->
            <div class="row">
                <div class="col-sm-7">
                    {{ form.support_from_MAPS.label_tag }}
                </div>
                <div class="col-sm-5">
                    {{ form.support_from_MAPS.errors }}
                </div>
                <div class="col-sm-12">
                    {{ form.support_from_MAPS }}
                </div>
            </div>

            <!-- Follow up method field -->
            <label>How would you like us to follow-up with you? (Fill at least ONE method below):</label>
            {{ form.non_field_errors }}

                <!-- Via email -->
                <div class="row">
                    <div class="control-label col-sm-3">
                        {{ form.follow_up_email.label_tag }} 
                    </div>
                    <div class="col-sm-3">
                        {{ form.follow_up_email }}
                    </div>
                </div>
                <!-- Via phone -->
                <div class="row">
                    <div class="control-label col-sm-3">
                        {{ form.follow_up_phone.label_tag }} 
                    </div>
                    <div class="col-sm-9 form-inline">
                        {{ form.follow_up_phone }}
                    </div>
                </div>
                <!-- By an appointment -->
                <div class="row">
                    <div class="control-label col-sm-3">
                        {{ form.follow_up_appointment.label_tag }} 
                    </div>
                    <div class="col-sm-3">
                        {{ form.follow_up_appointment }}
                    </div>
                </div>
            <br/>

            <!-- Submit button -->
            <div class="form-group text-center">
                <input class="btn btn-lg btn-success" type="submit" name="submit" value="Submit" />
            </div>

        <!-- END OF HIDDEN PART -->
        </div>
    </form>

</div>
{% endblock %}
